{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/donaldliu/Documents/ray-experiment/client/chat/ChatContainer.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/chat/ChatContainer.js","filename":"/Users/donaldliu/Documents/ray-experiment/client/chat/ChatContainer.js","passPerPreset":false,"envName":"development","cwd":"/Users/donaldliu/Documents/ray-experiment","root":"/Users/donaldliu/Documents/ray-experiment","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.9.2","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/donaldliu/Documents/ray-experiment/client/chat/ChatContainer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/chat/ChatContainer.js"}},"code":"let _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 1);\nmodule.export({\n  default: () => ChatContainer\n});\nmodule.link(\"./style.less\");\nlet PropTypes;\nmodule.link(\"prop-types\", {\n  default(v) {\n    PropTypes = v;\n  }\n\n}, 0);\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n\n}, 1);\nlet Footer;\nmodule.link(\"./Footer\", {\n  default(v) {\n    Footer = v;\n  }\n\n}, 2);\nlet Message;\nmodule.link(\"./Message\", {\n  default(v) {\n    Message = v;\n  }\n\n}, 3);\nlet Messages;\nmodule.link(\"./Messages\", {\n  default(v) {\n    Messages = v;\n  }\n\n}, 4);\nlet ChatHeader;\nmodule.link(\"./ChatHeader\", {\n  default(v) {\n    ChatHeader = v;\n  }\n\n}, 5);\nlet ErrorBoundary;\nmodule.link(\"./ErrorBoundary\", {\n  default(v) {\n    ErrorBoundary = v;\n  }\n\n}, 6);\n\nclass ChatContainer extends React.PureComponent {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      isActive: true,\n      isOpen: true\n    };\n\n    this.onTitleClick = () => {\n      const {\n        onOpenChat\n      } = this.props;\n      onOpenChat;\n      this.setState({\n        isOpen: !this.state.isOpen\n      });\n    };\n\n    this.onXClick = () => {\n      const {\n        customKey,\n        onCloseChat\n      } = this.props;\n      onCloseChat(customKey); // this.setState({ isActive: !this.state.isActive})\n    };\n\n    this.onNewMessage = msg => {\n      const {\n        onNewMessage,\n        scope,\n        customKey\n      } = this.props;\n\n      if (onNewMessage) {\n        msg = onNewMessage(msg);\n\n        if (!msg) {\n          console.log(\"new\");\n          return;\n        }\n      }\n\n      scope.append(customKey, msg);\n    };\n\n    this.componentDidMount = () => {\n      const {\n        dockStartOpen,\n        docked\n      } = this.props;\n\n      if (docked && !dockStartOpen) {\n        this.setState({\n          isOpen: false\n        });\n      }\n    };\n  }\n\n  render() {\n    const {\n      isOpen,\n      forceOpen\n    } = this.state;\n\n    const _this$props = this.props,\n          {\n      player,\n      scope,\n      customKey,\n      customClassName,\n      docked,\n      onIncomingMessage,\n      filter,\n      timeStamp,\n      otherPlayer,\n      header: HeaderComp,\n      message: MessageComp,\n      footer: FooterComp,\n      isActive,\n      playerIsOnline,\n      onCloseChat\n    } = _this$props,\n          rest = _objectWithoutProperties(_this$props, [\"player\", \"scope\", \"customKey\", \"customClassName\", \"docked\", \"onIncomingMessage\", \"filter\", \"timeStamp\", \"otherPlayer\", \"header\", \"message\", \"footer\", \"isActive\", \"playerIsOnline\", \"onCloseChat\"]);\n\n    const common = {\n      player,\n      scope,\n      customKey\n    };\n\n    if (!isActive) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(customClassName ? customClassName : \"empirica-chat-container\", \" \").concat(docked ? \"undocked\" : \"undocked\", \" \").concat(isOpen ? \"open\" : \"closed\")\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat \".concat(isOpen ? \"open\" : \"closed\")\n    }, docked && /*#__PURE__*/React.createElement(HeaderComp, _extends({}, common, {\n      otherPlayer: otherPlayer,\n      onTitleClick: this.onTitleClick,\n      onXClick: this.onXClick,\n      isOpen: isOpen,\n      playerIsOnline: playerIsOnline\n    })), isOpen ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Messages, _extends({}, common, {\n      messageComp: MessageComp,\n      filter: filter,\n      onIncomingMessage: onIncomingMessage\n    }, rest)), /*#__PURE__*/React.createElement(FooterComp, _extends({}, common, {\n      timeStamp: timeStamp,\n      onNewMessage: this.onNewMessage\n    }))) : \"\")));\n  }\n\n}\n\nChatContainer.defaultProps = {\n  customKey: \"chat\",\n  docked: false,\n  customClassName: \"\",\n  dockStartOpen: true,\n  hideAvatar: false,\n  hideName: false,\n  svgAvatar: false,\n  hideNotificiationBadge: false,\n  // header: ({ onClick, isOpen }) => (\n  //   <div className=\"header\">\n  //     <span className=\"title\">CHAT </span>\n  //     <span className=\"close-button\" onClick={onClick}>\n  //       {isOpen ? \"-\" : \"+\"}\n  //     </span>\n  //   </div>\n  // ),\n  header: ChatHeader,\n  message: Message,\n  footer: Footer\n};\nChatContainer.propTypes = {\n  player: PropTypes.object.isRequired,\n  scope: PropTypes.object.isRequired,\n  customKey: PropTypes.string.isRequired,\n  timeStamp: PropTypes.instanceOf(Date),\n  docked: PropTypes.bool,\n  dockStartOpen: PropTypes.bool,\n  hideAvatar: PropTypes.bool,\n  hideName: PropTypes.bool,\n  svgAvatar: PropTypes.bool,\n  customClassName: PropTypes.string,\n  onNewMessage: PropTypes.func,\n  onIncomingMessage: PropTypes.func,\n  filter: PropTypes.func,\n  header: PropTypes.elementType.isRequired,\n  message: PropTypes.elementType.isRequired,\n  footer: PropTypes.elementType.isRequired\n};","map":{"version":3,"sources":["client/chat/ChatContainer.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","export","ChatContainer","PropTypes","React","Footer","Message","Messages","ChatHeader","ErrorBoundary","PureComponent","state","isActive","isOpen","onTitleClick","onOpenChat","props","setState","onXClick","customKey","onCloseChat","onNewMessage","msg","scope","console","log","append","componentDidMount","dockStartOpen","docked","render","forceOpen","player","customClassName","onIncomingMessage","filter","timeStamp","otherPlayer","header","HeaderComp","message","MessageComp","footer","FooterComp","playerIsOnline","rest","common","defaultProps","hideAvatar","hideName","svgAvatar","hideNotificiationBadge","propTypes","object","isRequired","string","instanceOf","Date","bool","func","elementType"],"mappings":"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","sourcesContent":["import \"./style.less\";\n\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Footer from \"./Footer\";\nimport Message from \"./Message\";\nimport Messages from \"./Messages\";\nimport ChatHeader from \"./ChatHeader\";\nimport ErrorBoundary from \"./ErrorBoundary\";\n\nexport default class ChatContainer extends React.PureComponent {\n  state = { \n    isActive: true,\n    isOpen: true,\n  };\n\n  onTitleClick = () => {\n    const {onOpenChat} = this.props;\n    onOpenChat\n    this.setState({ isOpen: !this.state.isOpen});\n  };\n\n  onXClick = () => {\n    const {customKey, onCloseChat} = this.props;\n    onCloseChat(customKey);\n    // this.setState({ isActive: !this.state.isActive})\n  };\n\n  onNewMessage = (msg) => {\n    const { onNewMessage, scope, customKey } = this.props;\n\n    if (onNewMessage) {\n      msg = onNewMessage(msg);\n      if (!msg) {\n        console.log(\"new\");\n        return;\n      }\n    }\n\n    scope.append(customKey, msg);\n  };\n\n  componentDidMount = () => {\n    const { dockStartOpen, docked } = this.props;\n    if (docked && !dockStartOpen) {\n      this.setState({\n        isOpen: false,\n      });\n    }\n  };\n\n  render() {\n    const { isOpen, forceOpen } = this.state;\n    const {\n      player,\n      scope,\n      customKey,\n      customClassName,\n      docked,\n      onIncomingMessage,\n\n      filter,\n      timeStamp,\n      otherPlayer,\n      header: HeaderComp,\n      message: MessageComp,\n      footer: FooterComp,\n      isActive,\n      playerIsOnline,\n      onCloseChat,\n      ...rest\n    } = this.props;\n\n    const common = { player, scope, customKey };\n    if (!isActive) {\n      return null;\n    }\n\n    return (\n      <ErrorBoundary>\n        <div\n          className={`${\n            customClassName ? customClassName : \"empirica-chat-container\"\n          } ${docked ? \"undocked\" : \"undocked\"} ${isOpen ? \"open\" : \"closed\"}`}\n        >\n          <div className={`chat ${isOpen ? \"open\" : \"closed\"}`}>\n            {docked && (\n              <HeaderComp {...common} otherPlayer={otherPlayer} onTitleClick={this.onTitleClick} onXClick={this.onXClick} isOpen={isOpen} playerIsOnline={playerIsOnline} />\n            )}\n            {isOpen ? (\n              <>\n                <Messages\n                  {...common}\n                  messageComp={MessageComp}\n                  filter={filter}\n                  onIncomingMessage={onIncomingMessage}\n                  {...rest}\n                />\n                <FooterComp\n                  {...common}\n                  timeStamp={timeStamp}\n                  onNewMessage={this.onNewMessage}\n                />\n              </>\n            ) : (\n              \"\"\n            )}\n          </div>\n        </div>\n      </ErrorBoundary>\n    );\n  }\n}\n\nChatContainer.defaultProps = {\n  customKey: \"chat\",\n  docked: false,\n  customClassName: \"\",\n  dockStartOpen: true,\n  hideAvatar: false,\n  hideName: false,\n  svgAvatar: false,\n  hideNotificiationBadge: false,\n  // header: ({ onClick, isOpen }) => (\n  //   <div className=\"header\">\n  //     <span className=\"title\">CHAT </span>\n  //     <span className=\"close-button\" onClick={onClick}>\n  //       {isOpen ? \"-\" : \"+\"}\n  //     </span>\n  //   </div>\n  // ),\n  header: ChatHeader,\n  message: Message,\n  footer: Footer,\n};\n\nChatContainer.propTypes = {\n  player: PropTypes.object.isRequired,\n  scope: PropTypes.object.isRequired,\n  customKey: PropTypes.string.isRequired,\n  timeStamp: PropTypes.instanceOf(Date),\n  docked: PropTypes.bool,\n  dockStartOpen: PropTypes.bool,\n  hideAvatar: PropTypes.bool,\n  hideName: PropTypes.bool,\n  svgAvatar: PropTypes.bool,\n  customClassName: PropTypes.string,\n\n  onNewMessage: PropTypes.func,\n  onIncomingMessage: PropTypes.func,\n  filter: PropTypes.func,\n\n  header: PropTypes.elementType.isRequired,\n  message: PropTypes.elementType.isRequired,\n  footer: PropTypes.elementType.isRequired,\n};\n"]},"sourceType":"module","hash":"f3de644ef60ed70e53555d75fb50825aedf0a7aa"}
