{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/donaldliu/Documents/ray-experiment/client/chat/ChatContainer.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"client/chat/ChatContainer.js","filename":"/Users/donaldliu/Documents/ray-experiment/client/chat/ChatContainer.js","passPerPreset":false,"envName":"development","cwd":"/Users/donaldliu/Documents/ray-experiment","root":"/Users/donaldliu/Documents/ray-experiment","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.9.2","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/donaldliu/Documents/ray-experiment/client/chat/ChatContainer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"client/chat/ChatContainer.js"}},"code":"let _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 1);\nmodule.export({\n  default: () => ChatContainer\n});\nmodule.link(\"./style.less\");\nlet PropTypes;\nmodule.link(\"prop-types\", {\n  default(v) {\n    PropTypes = v;\n  }\n\n}, 0);\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n\n}, 1);\nlet Footer;\nmodule.link(\"./Footer\", {\n  default(v) {\n    Footer = v;\n  }\n\n}, 2);\nlet Message;\nmodule.link(\"./Message\", {\n  default(v) {\n    Message = v;\n  }\n\n}, 3);\nlet Messages;\nmodule.link(\"./Messages\", {\n  default(v) {\n    Messages = v;\n  }\n\n}, 4);\nlet ChatHeader;\nmodule.link(\"./ChatHeader\", {\n  default(v) {\n    ChatHeader = v;\n  }\n\n}, 5);\nlet ErrorBoundary;\nmodule.link(\"./ErrorBoundary\", {\n  default(v) {\n    ErrorBoundary = v;\n  }\n\n}, 6);\n\nclass ChatContainer extends React.PureComponent {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      isActive: true,\n      isOpen: true\n    };\n\n    this.onTitleClick = () => {\n      this.setState({\n        isOpen: !this.state.isOpen\n      });\n    };\n\n    this.onXClick = () => {\n      const {\n        customKey,\n        onCloseChat\n      } = this.props;\n      onCloseChat(customKey); // this.setState({ isActive: !this.state.isActive})\n    };\n\n    this.openChatOnIncomingMessage = () => {};\n\n    this.onNewMessage = msg => {\n      const {\n        onNewMessage,\n        scope,\n        customKey\n      } = this.props;\n\n      if (onNewMessage) {\n        msg = onNewMessage(msg);\n\n        if (!msg) {\n          return;\n        }\n      }\n\n      scope.append(customKey, msg);\n    };\n\n    this.componentDidMount = () => {\n      const {\n        dockStartOpen,\n        docked\n      } = this.props;\n\n      if (docked && !dockStartOpen) {\n        this.setState({\n          isOpen: false\n        });\n      }\n    };\n  }\n\n  render() {\n    const {\n      isOpen\n    } = this.state;\n\n    const _this$props = this.props,\n          {\n      player,\n      scope,\n      customKey,\n      customClassName,\n      docked,\n      onIncomingMessage,\n      filter,\n      timeStamp,\n      otherPlayer,\n      header: HeaderComp,\n      message: MessageComp,\n      footer: FooterComp,\n      isActive,\n      onCloseChat\n    } = _this$props,\n          rest = _objectWithoutProperties(_this$props, [\"player\", \"scope\", \"customKey\", \"customClassName\", \"docked\", \"onIncomingMessage\", \"filter\", \"timeStamp\", \"otherPlayer\", \"header\", \"message\", \"footer\", \"isActive\", \"onCloseChat\"]);\n\n    const common = {\n      player,\n      scope,\n      customKey\n    };\n\n    if (!isActive) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(customClassName ? customClassName : \"empirica-chat-container\", \" \").concat(docked ? \"undocked\" : \"undocked\")\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat \".concat(isOpen ? \"open\" : \"\")\n    }, docked && /*#__PURE__*/React.createElement(HeaderComp, _extends({}, common, {\n      otherPlayer: otherPlayer,\n      onTitleClick: this.onTitleClick,\n      onXClick: this.onXClick,\n      isOpen: isOpen\n    })), isOpen ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Messages, _extends({}, common, {\n      messageComp: MessageComp,\n      filter: filter,\n      onIncomingMessage: onIncomingMessage\n    }, rest)), /*#__PURE__*/React.createElement(FooterComp, _extends({}, common, {\n      timeStamp: timeStamp,\n      onNewMessage: this.onNewMessage\n    }))) : \"\")));\n  }\n\n}\n\nChatContainer.defaultProps = {\n  customKey: \"chat\",\n  docked: false,\n  customClassName: \"\",\n  dockStartOpen: true,\n  hideAvatar: false,\n  hideName: false,\n  svgAvatar: false,\n  hideNotificiationBadge: false,\n  // header: ({ onClick, isOpen }) => (\n  //   <div className=\"header\">\n  //     <span className=\"title\">CHAT </span>\n  //     <span className=\"close-button\" onClick={onClick}>\n  //       {isOpen ? \"-\" : \"+\"}\n  //     </span>\n  //   </div>\n  // ),\n  header: ChatHeader,\n  message: Message,\n  footer: Footer\n};\nChatContainer.propTypes = {\n  player: PropTypes.object.isRequired,\n  scope: PropTypes.object.isRequired,\n  customKey: PropTypes.string.isRequired,\n  timeStamp: PropTypes.instanceOf(Date),\n  docked: PropTypes.bool,\n  dockStartOpen: PropTypes.bool,\n  hideAvatar: PropTypes.bool,\n  hideName: PropTypes.bool,\n  svgAvatar: PropTypes.bool,\n  customClassName: PropTypes.string,\n  onNewMessage: PropTypes.func,\n  onIncomingMessage: PropTypes.func,\n  filter: PropTypes.func,\n  header: PropTypes.elementType.isRequired,\n  message: PropTypes.elementType.isRequired,\n  footer: PropTypes.elementType.isRequired\n};","map":{"version":3,"sources":["client/chat/ChatContainer.js"],"names":["_extends","module","link","default","v","_objectWithoutProperties","export","ChatContainer","PropTypes","React","Footer","Message","Messages","ChatHeader","ErrorBoundary","PureComponent","state","isActive","isOpen","onTitleClick","setState","onXClick","customKey","onCloseChat","props","openChatOnIncomingMessage","onNewMessage","msg","scope","append","componentDidMount","dockStartOpen","docked","render","player","customClassName","onIncomingMessage","filter","timeStamp","otherPlayer","header","HeaderComp","message","MessageComp","footer","FooterComp","rest","common","defaultProps","hideAvatar","hideName","svgAvatar","hideNotificiationBadge","propTypes","object","isRequired","string","instanceOf","Date","bool","func","elementType"],"mappings":"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","sourcesContent":["import \"./style.less\";\n\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Footer from \"./Footer\";\nimport Message from \"./Message\";\nimport Messages from \"./Messages\";\nimport ChatHeader from \"./ChatHeader\";\nimport ErrorBoundary from \"./ErrorBoundary\";\n\nexport default class ChatContainer extends React.PureComponent {\n  state = { \n    isActive: true,\n    isOpen: true \n  };\n\n  onTitleClick = () => {\n    this.setState({ isOpen: !this.state.isOpen });\n  };\n\n  onXClick = () => {\n    const {customKey, onCloseChat} = this.props;\n    onCloseChat(customKey);\n    // this.setState({ isActive: !this.state.isActive})\n  };\n\n  openChatOnIncomingMessage = () => {\n    \n  }\n\n  onNewMessage = (msg) => {\n    const { onNewMessage, scope, customKey } = this.props;\n\n    if (onNewMessage) {\n      msg = onNewMessage(msg);\n      if (!msg) {\n        return;\n      }\n    }\n\n    scope.append(customKey, msg);\n  };\n\n  componentDidMount = () => {\n    const { dockStartOpen, docked } = this.props;\n    if (docked && !dockStartOpen) {\n      this.setState({\n        isOpen: false,\n      });\n    }\n  };\n\n  render() {\n    const { isOpen } = this.state;\n    const {\n      player,\n      scope,\n      customKey,\n      customClassName,\n      docked,\n      onIncomingMessage,\n\n      filter,\n      timeStamp,\n      otherPlayer,\n      header: HeaderComp,\n      message: MessageComp,\n      footer: FooterComp,\n      isActive,\n      onCloseChat,\n      ...rest\n    } = this.props;\n\n    const common = { player, scope, customKey };\n    if (!isActive) {\n      return null;\n    }\n\n    return (\n      <ErrorBoundary>\n        <div\n          className={`${\n            customClassName ? customClassName : \"empirica-chat-container\"\n          } ${docked ? \"undocked\" : \"undocked\"}`}\n        >\n          <div className={`chat ${isOpen ? \"open\" : \"\"}`}>\n            {docked && (\n              <HeaderComp {...common} otherPlayer={otherPlayer} onTitleClick={this.onTitleClick} onXClick={this.onXClick} isOpen={isOpen} />\n            )}\n            {isOpen ? (\n              <>\n                <Messages\n                  {...common}\n                  messageComp={MessageComp}\n                  filter={filter}\n                  onIncomingMessage={onIncomingMessage}\n                  {...rest}\n                />\n                <FooterComp\n                  {...common}\n                  timeStamp={timeStamp}\n                  onNewMessage={this.onNewMessage}\n                />\n              </>\n            ) : (\n              \"\"\n            )}\n          </div>\n        </div>\n      </ErrorBoundary>\n    );\n  }\n}\n\nChatContainer.defaultProps = {\n  customKey: \"chat\",\n  docked: false,\n  customClassName: \"\",\n  dockStartOpen: true,\n  hideAvatar: false,\n  hideName: false,\n  svgAvatar: false,\n  hideNotificiationBadge: false,\n  // header: ({ onClick, isOpen }) => (\n  //   <div className=\"header\">\n  //     <span className=\"title\">CHAT </span>\n  //     <span className=\"close-button\" onClick={onClick}>\n  //       {isOpen ? \"-\" : \"+\"}\n  //     </span>\n  //   </div>\n  // ),\n  header: ChatHeader,\n  message: Message,\n  footer: Footer,\n};\n\nChatContainer.propTypes = {\n  player: PropTypes.object.isRequired,\n  scope: PropTypes.object.isRequired,\n  customKey: PropTypes.string.isRequired,\n  timeStamp: PropTypes.instanceOf(Date),\n  docked: PropTypes.bool,\n  dockStartOpen: PropTypes.bool,\n  hideAvatar: PropTypes.bool,\n  hideName: PropTypes.bool,\n  svgAvatar: PropTypes.bool,\n  customClassName: PropTypes.string,\n\n  onNewMessage: PropTypes.func,\n  onIncomingMessage: PropTypes.func,\n  filter: PropTypes.func,\n\n  header: PropTypes.elementType.isRequired,\n  message: PropTypes.elementType.isRequired,\n  footer: PropTypes.elementType.isRequired,\n};\n"]},"sourceType":"module","hash":"27e51beceffe1fc6c02ea0cb144c75cc496bc62d"}
